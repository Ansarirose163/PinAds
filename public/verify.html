<!DOCTYPE html>
<html>
<head>
    <title>Verify Device</title>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const deviceId = urlParams.get('deviceId');
            
            if (deviceId) {
                checkVerification(deviceId);
            }

            function checkVerification(deviceId) {
                fetch(`/.netlify/functions/check-verification?deviceId=${deviceId}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.verified) {
                            // Close window after 3 seconds
                            setTimeout(() => {
                                window.close();
                            }, 3000);
                        }
                    });
            }
        });
    </script>
</head>
<body>
    <h1>Verification in Progress</h1>
    <p>Please wait while we verify your device...</p>
</body>
</html>
